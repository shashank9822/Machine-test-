<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>AKS Machine Test - Categories</title>
<link rel="stylesheet" href="css/style.css">
<!--[if lt IE 9]>
<script type="text/javascript" src="html5.js"></script>
<![endif]-->
<!--[if lt IE 7.]>
<script defer type="text/javascript" src="pngfix1.js"></script>
<![endif]-->

<!-- Menu start --------------->
<link href="menu/quickmenu0.css" rel="stylesheet" type="text/css" media="screen" />
<script type="text/javascript" src="menu/quickmenu0.js"></script>
<!-- Menu End --------------->
<style>
    /* Added styles for status and interactions */
    .status-active { color: green; font-weight: bold; }
    .status-inactive { color: red; }
    .action-btn { cursor: pointer; margin: 0 5px; }
    #categoryTable tbody tr:hover { background-color: #f5f5f5; }
    .highlight { background-color: #fffde7; }
    .form-raw { margin-bottom: 10px; }
</style>
</head>
<body>
<header>
  <div id="wrap">
       <div class="logo"><img src="images/logo.png" border="0"></div>
    <div class="topmenu">
      <ul>
        <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
        <li><a href="change-password.html">Change Password</a>&nbsp;|</li>
        <li><a href="index.html" id="logoutBtn"><img src="images/logout.png" width="16" height="16" border="0" align="absmiddle">&nbsp;&nbsp;Logout</a></li>
      </ul>
      <div class="clear"></div>
    </div>
    <div class="clear"></div>
  </div>
  <div class="clear"></div>
</header>
<nav>
  <ul id="qm0" class="qmmc">
    <li><a href="admin.html">Dashboard</a></li>
    <li><a href="#">Product</a>
        <ul>
          <li><a href="add-category.html">Add Category</a></li>
          <li><a href="add-sub-category.html">Add Sub Category</a></li>
          <li><a href="product.html">Add Product</a></li>
        </ul>
    </li>    
  </ul>
</nav>
  
<div id="wrap">
  <div class="clear" style="height:5px;"></div>
  <div id="wrap2">
    <h1>Add Category</h1>
    <br>
    <div class="form-raw">
      <div class="form-name">Category Name</div>
      <div class="form-txtfld">
        <input type="text" id="categoryName">
      </div>
    </div>
    <div class="clear"></div>
    <div class="form-raw">
      <div class="form-name">Active</div>
      <div class="form-txtfld">
        <input type="checkbox" id="isActive" checked>
      </div>      
      <div class="clear"></div>
    </div>
    <div class="form-raw">
      <div class="form-name">&nbsp;</div>
      <div class="form-txtfld" style="width:290px;">
        <input type="button" class="btn" id="submitBtn" value="Submit">
        <input type="hidden" id="editId" value="">
      </div>
    </div>
  </div>
  <div class="clear">&nbsp;</div>
</div>
<div id="wrap3">
  <table width="100%" border="0" cellspacing="0" cellpadding="0" class="admintable" id="categoryTable">
    <thead>
      <tr>
        <th width="59" align="left" valign="middle">Sr.No.</th>
        <th width="752" align="left" valign="middle">Category Name</th>
        <th width="77" align="left" valign="middle">Status</th>
        <th width="54" align="left" valign="middle">Edit</th>
        <th width="71" align="left" valign="middle">Remove</th>
      </tr>
    </thead>
    <tbody id="categoryList">
      <!-- Categories will be loaded here -->
    </tbody>
  </table>
  <div class="clear">&nbsp;</div>
</div>
<div class="clear"></div>
<footer>
  <footer class="whitefoter">
    <div class="whitefooter-cont">
      <div style="float:left;">Copyright Â© AKS Machine Test. All Rights Reserved.</div>      
           <a href="https://www.akswebsoft.com/" target="_blank" style="float:right;">
                <img src="images/akslogo.png" alt="AKS Websoft Consulting Pvt. Ltd." title="AKS Websoft Consulting Pvt. Ltd."></a>
      <div class="clear"></div>
    </div>
  </footer>
</footer>

<script>
// Category Management System
document.addEventListener('DOMContentLoaded', function() {
    // Check if user is logged in
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    const userEmail = localStorage.getItem('userEmail');
    
    if (!isLoggedIn || !userEmail) {
        window.location.href = 'index.html';
        return;
    }

    // Initialize categories in localStorage if not exists
    if (!localStorage.getItem('categories')) {
        localStorage.setItem('categories', JSON.stringify([]));
    }

    // DOM elements
    const categoryNameInput = document.getElementById('categoryName');
    const isActiveCheckbox = document.getElementById('isActive');
    const submitBtn = document.getElementById('submitBtn');
    const editIdInput = document.getElementById('editId');
    const categoryList = document.getElementById('categoryList');
    const logoutBtn = document.getElementById('logoutBtn');

    // Load categories on page load
    loadCategories();

    // Submit button event
    submitBtn.addEventListener('click', function() {
        const categoryName = categoryNameInput.value.trim();
        const isActive = isActiveCheckbox.checked;
        const editId = editIdInput.value;

        if (!categoryName) {
            alert('Please enter category name');
            return;
        }

        if (editId) {
            // Update existing category
            updateCategory(editId, categoryName, isActive);
        } else {
            // Add new category
            addCategory(categoryName, isActive);
        }
    });

    // Logout button event
    logoutBtn.addEventListener('click', function(e) {
        e.preventDefault();
        localStorage.removeItem('isLoggedIn');
        window.location.href = 'index.html';
    });

    // Function to load categories
    function loadCategories() {
        const categories = JSON.parse(localStorage.getItem('categories'));
        const userEmail = localStorage.getItem('userEmail');
        
        // Filter categories by current user
        const userCategories = categories.filter(cat => cat.createdBy === userEmail);
        
        categoryList.innerHTML = '';
        
        if (userCategories.length === 0) {
            categoryList.innerHTML = '<tr><td colspan="5" align="center">No categories found</td></tr>';
            return;
        }
        
        userCategories.forEach((category, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td align="left" valign="top">${index + 1}</td>
                <td align="left" valign="top">${category.name}</td>
                <td align="left" valign="top" class="${category.isActive ? 'status-active' : 'status-inactive'}">
                    ${category.isActive ? 'Active' : 'Inactive'}
                </td>
                <td align="left" valign="top">
                    <a href="#" class="action-btn edit-btn" data-id="${category.id}">Edit</a>
                </td>
                <td align="center" valign="top">
                    <img src="images/icon-bin.jpg" class="action-btn delete-btn" 
                         data-id="${category.id}" width="25" height="25" border="0" align="absmiddle">
                </td>
            `;
            categoryList.appendChild(row);
        });

        // Add event listeners to edit buttons
        document.querySelectorAll('.edit-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const id = this.getAttribute('data-id');
                editCategory(id);
            });
        });

        // Add event listeners to delete buttons
        document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const id = this.getAttribute('data-id');
                if (confirm('Are you sure you want to delete this category?')) {
                    deleteCategory(id);
                }
            });
        });
    }

    // Function to add a new category
    function addCategory(name, isActive) {
        const categories = JSON.parse(localStorage.getItem('categories'));
        const userEmail = localStorage.getItem('userEmail');
        
        const newCategory = {
            id: Date.now().toString(),
            name: name,
            isActive: isActive,
            createdBy: userEmail,
            createdAt: new Date().toISOString()
        };
        
        categories.push(newCategory);
        localStorage.setItem('categories', JSON.stringify(categories));
        
        // Reset form and reload
        resetForm();
        loadCategories();
    }

    // Function to update a category
    function updateCategory(id, name, isActive) {
        const categories = JSON.parse(localStorage.getItem('categories'));
        const categoryIndex = categories.findIndex(cat => cat.id === id);
        
        if (categoryIndex !== -1) {
            categories[categoryIndex].name = name;
            categories[categoryIndex].isActive = isActive;
            
            localStorage.setItem('categories', JSON.stringify(categories));
            resetForm();
            loadCategories();
        }
    }

    // Function to edit a category
    function editCategory(id) {
        const categories = JSON.parse(localStorage.getItem('categories'));
        const category = categories.find(cat => cat.id === id);
        
        if (category) {
            categoryNameInput.value = category.name;
            isActiveCheckbox.checked = category.isActive;
            editIdInput.value = category.id;
            submitBtn.value = 'Update';
            
            // Highlight the row being edited
            document.querySelectorAll('#categoryList tr').forEach(row => {
                row.classList.remove('highlight');
                if (row.querySelector(`.edit-btn[data-id="${id}"]`)) {
                    row.classList.add('highlight');
                }
            });
            
            categoryNameInput.focus();
        }
    }

    // Function to delete a category
    function deleteCategory(id) {
        let categories = JSON.parse(localStorage.getItem('categories'));
        categories = categories.filter(cat => cat.id !== id);
        localStorage.setItem('categories', JSON.stringify(categories));
        loadCategories();
    }

    // Function to reset the form
    function resetForm() {
        categoryNameInput.value = '';
        isActiveCheckbox.checked = true;
        editIdInput.value = '';
        submitBtn.value = 'Submit';
        
        // Remove highlights
        document.querySelectorAll('#categoryList tr').forEach(row => {
            row.classList.remove('highlight');
        });
    }
});
</script>
</body>
</html>